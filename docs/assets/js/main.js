"use strict";const btn=document.querySelector(".js-searchBtn"),rsltContainer=document.querySelector(".js-searchContainer"),favContainer=document.querySelector(".js-favContainer"),input=document.querySelector(".js-input"),clearBtn=document.querySelector(".js-clearFavBtn");let item,isFav,results=[],favList=[];function handleSearch(){getData()}function getData(){const t=input.value;fetch("//api.tvmaze.com/search/shows?q="+t).then((function(t){return t.json()})).then((function(t){results=t,paintResults(),listenToCards()}))}function paintResults(){let t="";for(item=0;item<results.length;item++){let e=results[item].show.id;isFav=favList.findIndex(t=>t.show.id===e),t+=-1!==isFav?`<li class="card highlightCard js-card" id="${item}">`:`<li class="card js-card" id="${item}">`,t+=`<h3 class="card__title">${results[item].show.name}</h3>`,null===results[item].show.image?t+='<img class="card__img" src="//via.placeholder.com/210x296/f0ffff/00008b/?text=No+image+available"/>':t+=`<img class="card__img" src="${results[item].show.image.medium}"/>`,null===results[item].show.rating.average?t+='<p class="card__rating">Valoración: No disponible</p>':t+=`<p class="card__rating">Valoración: ${results[item].show.rating.average}</p>`,t+=`<a class="card__link" target="_blank" href="${results[item].show.url}">Más info</a>`,t+="</li>"}rsltContainer.innerHTML=t}function listenToCards(){const t=document.querySelectorAll(".js-card");for(const e of t)e.addEventListener("click",handleFav)}function handleFav(t){let e;e=parseInt(t.currentTarget.id);const a=results[e];isFav=favList.findIndex(t=>t.show.id===a.show.id),-1===isFav?(favList.push(results[e]),t.currentTarget.classList.add("highlightCard"),paintFav()):isFav>-1&&(favList.splice(isFav,1),t.currentTarget.classList.remove("highlightCard"),paintFav())}function paintFav(){let t="";for(item=0;item<favList.length;item++)t+=`<li class="favCard js-card" id="${item}">`,t+=`<h3 class="favCard__title">${favList[item].show.name}</h3>`,null===favList[item].show.image?t+='<img class="favCard__img" src="//via.placeholder.com/210x296/f0ffff/00008b/?text=No+image+available"/>':t+=`<img class="favCard__img" src="${favList[item].show.image.medium}"/>`,t+="</li>";favContainer.innerHTML=t,setLocalStorage()}function clearFav(){favContainer.innerHTML="",favList.length=0,setLocalStorage()}function setLocalStorage(){localStorage.setItem("favList",JSON.stringify(favList))}function getLocalStorage(){const t=localStorage.getItem("favList");if(null==t)favList=[];else{const e=JSON.parse(t);favList=e,paintFav()}}getLocalStorage(),btn.addEventListener("click",handleSearch),clearBtn.addEventListener("click",clearFav);